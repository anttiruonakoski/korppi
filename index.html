<!DOCTYPE html>
<!-- etaoin shrdlu-->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />

    <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Havaintojärjestelmä 2017 karttademo</title>

    <link rel="apple-touch-icon" sizes="57x57" href="images/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="images/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="images/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-icon-180x180.png">
    <link rel="icon" type="imageimages/favicons/png" sizes="192x192"  href="images/favicons/android-icon-192x192.png">
    <link rel="icon" type="imageimages/favicons/png" sizes="32x32" href="images/favicons/favicon-32x32.png">
    <link rel="icon" type="imageimages/favicons/png" sizes="96x96" href="images/favicons/favicon-96x96.png">
    <link rel="icon" type="imageimages/favicons/png" sizes="16x16" href="images/favicons/favicon-16x16.png">
    <link rel="manifest" href="images/favicons/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="images/favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

<!--     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css"> -->

<link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">

   <!--  integrity attribute causes loading twice	 -->
   <!--  integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous"> -->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />

    <link rel="stylesheet" href="bower_components/Leaflet.awesome-markers/dist/leaflet.awesome-markers.css">
    <link rel="stylesheet" href="bower_components/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />

   
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
    <link rel="stylesheet" href="lib/leaflet-measure-path/leaflet-measure-path.css" />

    <link rel="stylesheet" type="text/css" href="styles/korppi_style.css" />
    <!--site dependencies. manage with bower later maybe-->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script> 

  <!--   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script> -->

    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.4.4/proj4.js"></script>

    <!-- promise library -->

    <!-- leaflet libraries already bower components -->

    <script src="bower_components/Proj4Leaflet/src/proj4leaflet.js"></script>
    <script src="bower_components/Leaflet.MML-layers/mmlLayers.js"></script>
    <script src="bower_components/leaflet.locatecontrol/dist/L.Control.Locate.min.js"></script>
		<script src="bower_components/Leaflet.awesome-markers/dist/leaflet.awesome-markers.js"></script>
		<script src="bower_components/leaflet-ajax/dist/leaflet.ajax.min.js"></script>
		<script src="lib/leaflet-measure-path/leaflet-measure-path.js"></script>
		<script src="bower_components/leaflet-rotatedmarker/leaflet.rotatedMarker.js"></script>

		<!-- <script src="bower_components/Leaflet.Control.Custom.js"></script> -->
		<script src="bower_components/list.js/dist/list.min.js" type="text/javascript"></script> 
    <!--korppi app javascript files-->
    <script src="js/bootstraphelper.js" type="text/javascript"></script>
    <script src="js/wfs_queries.js" type="text/javascript"></script>
    <script src="js/jsonfunctions.js" type="text/javascript"></script>
   <!--  <script src="js/testfunctions.js" type="text/javascript"></script> -->
		<script src="js/main.js" type="text/javascript"></script>

  	<script type="text/javascript">  
			
    //initialize page
    $(function() { 
      	init();
    }); 

    </script>
	</head>

  <body>
  	<div class="container-fluid">

  	<div id="main_div" class="bg-light ml-0 ml-sm-0 ml-md-1 ml-lg-1 mt-0 mt-sm-0 mt-md-1 mt-lg-1 clearfix">

   	<div class="row">	
   	<div class="col-lg-8 col-md-7 col-sm-12" id="map_div">

<!--  tool buttons on map (hack) should be a proper leaflet control-->   			
 		<div id="obs-tools" class="leaflet-control leaflet-control-layers leaflet-control-layers-expanded">
    <div class="btn-group" data-toggle="buttons" aria-label="obs-tools" id="obs-tools-primary">
     	<label class="btn btn-secondary active" id="btn-observer" data-toggle="tooltip" data-placement="bottom" title="Aseta havainnoija" >
     		<input type="radio" name="options" autocomplete="off" id="btn-observer-label" >	
       	<i class="fa fa-binoculars" aria-hidden="true"></i>
      </label>     	
      <label class="btn btn-secondary" id="btn-bird" data-toggle="tooltip" data-placement="bottom" title="Aseta lintu">
      	<input type="radio" name="options" autocomplete="off" >
       	<i class="fa fa-twitter" aria-hidden="true"></i>
      </label> 	

    <!-- secondary tools -->
     
      <label class="btn btn-secondary" id="btn-move" data-toggle="tooltip" data-placement="bottom" title="Siirrä karttaa">
     		<input type="radio" name="options" autocomplete="off" >
    		<i class="fa fa-arrows" aria-hidden="true"></i>
    	</label>
     	<label class="btn btn-secondary" id="btn-ruler" data-toggle="tooltip" data-placement="bottom" title="Mittaa matka">
     		<input type="radio" name="options" autocomplete="off" >
     		<i class="fa fa-arrows-h" aria-hidden="true"></i>
     	</label>

    </div>
    <div class="btn-group mx-0 ml-lg-2" role="group btn-group-sm" aria-label="tools"> 		

      <!--  <button type="button" class="btn btn-secondary btn-sm" id="btn-x" data-toggle="tooltip" data-placement="bottom" title="empty for a while"><i class="fa fa-question" aria-hidden="true"></i></button> -->
      <button type="button" class="btn btn-secondary" id="btn-obs-center" data-toggle="tooltip" data-placement="bottom" title="Keskitä havainnoijaan"><i class="fa fa-crosshairs" aria-hidden="true"></i></button>
      <button type="button" class="btn btn-secondary" id="btn-obs-centerzoom" data-toggle="tooltip" data-placement="bottom" title="Keskitä ja zoomaa havainnoijaan"><i class="fa fa-search-plus" aria-hidden="true"></i></button> 
    </div> 
    <!-- end  -->   

   <div class="btn-group ml-0 ml-lg-2" role="group btn-group-sm" aria-label="tools">

    <button type="button" class="btn btn-danger" id="btn-reset-map" data-toggle="tooltip" data-placement="bottom" title="Palauta kartta alkuun"><i class="fa fa-reply" aria-hidden="true"></i></button>
    <button type="button" class="btn btn-danger" id="btn-trash-all" data-toggle="tooltip" data-placement="bottom" title="Tyhjennä paikkatiedot"><i class="fa fa-trash" aria-hidden="true"></i></button>
  </div>

    </div> 

		</div>
<!-- 		end of map_div   -->

    <div class="col-lg-4 col-md-5 col-12 pl-md-1 pl-lg-3 pl-1 pr-1 mt-1 mt-sm-1 mt-md-1 mt-lg-0 mt-xl-0" id="lomake">
    		<div class="row hack">  

				<div class="col-xl-3 col-auto">
    	  <button class="btn btn-primary btn-sm mb-1" type="button" id="common-sites" data-toggle="modal" data-target="#site-list-modal">Hae listalta</button>
    	  </div>
				
    	  <div class="col-auto">
    	  <div class="dropdown">

    	  			<button class="btn btn-secondary btn-sm dropdown-toggle clear-right" type="button" id="common-sites-changer" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="soc-selected">Lapin lintutieteellinen yhdistys ry</button>
    	  			<div class="dropdown-menu" aria-labelledby="common-sites-changer">
    	  				<h6 class="dropdown-header">Yhdistys, jonka havaintopaikat näytetään</h6>
    						<a class="dropdown-item" href="#" data-id="25" >Kemi-Tornion lintuharrastajat Xenus ry</a>
    						<a class="dropdown-item" href="#" data-id="12">Suomenselän Lintutieteellinen Yhdistys ry (SSLTY)</a>
    						<a class="dropdown-item" href="#" data-id="10">Turun Lintutieteellinen Yhdistys ry</a>
                <a class="dropdown-item" href="#" data-id="11"></a>
                <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" data-id="99">Koko Suomi</a>
                </div>


    					<!-- this menu could be populated from a static json file with click listeners. events should load geoJSON, which includes obs points and update layers, update text in button id="common-sites-changer" and "disable" respective dropdown-item.-->

    		</div>	
    	  </div>	
    	

	<div class="col">
				Havainnoijan paikka
				<form class="needs-validation" id="obs-form" novalidate>
          <div class="form-group">
            <div class="row m-0 p-0 justify-content-start">
              <div class="col-lg-3 col-sm-3 col-3 mr-1 p-0">
    				    <label class="mb-0"><small>P-koord:</small></label>
    				    <input type="text" class="form-control form-control-sm" id="obs-n-koord" placeholder="0000000" size="8" disabled>
              </div>
              <div class="col-lg-3 col-sm-3 col-3 mx-1 p-0">
    				    <label class="mb-0"><small>I-koord:</small></label>
    				    <input type="text" class="form-control form-control-sm" id="obs-e-koord" placeholder="000000" size="6" disabled>	
              </div>  
              <div class="col-lg-3 col-sm-3 col-auto mx-1 p-0 align-self-end">
                <label class="mb-0 d-block"><small>Tarkkuus:</small></label>
                <select class="custom-select form-control-sm d-block" id="obs-accuracy" disabled>
                  <option selected value="0">ei määr.</option>
                  <option value="50">alle 50 m</option>
                  <option value="200">alle 200 m</option>
                  <option value="1000">alle 1 km</option>
                  <option value="5000">alle 5 km</option>
                  <option value="5001">yli 5 km</option>
                  </select>

              </div> 

              <div class="btn-group col-lg-2 col-sm-1 col-1 p-0 m-0 align-self-end" data-toggle="buttons">   
                  <button type="button" class="btn btn-sm btn-danger" id="btn-clear-obs" data-toggle="tooltip" data-placement="bottom" title="Tyhjennä havaintopaikka"><i class="fa fa-times" aria-hidden="true"></i></button>

                  <label class="btn btn-sm btn-secondary active" id="btn-get-placenames">
                  <input type="checkbox" checked autocomplete="off">
                  <i class="fa fa-paper-plane" aria-hidden="true"></i> </label>
                  
              </div> 
            </div>   
    				<label class="d-sm-none d-lg-inline"><small>Kunta:</small></label>
    				<input type="text" class="form-control form-control-sm my-sm-1 my-md-1 my-lg-0" id="obs-kunta-name" placeholder="ei kuntaa" size="25" disabled/>
                <div class="invalid-feedback">
                    Et voi asettaa havaintopaikkaa Suomen ulkopuolelle.
                </div>
    				<label class="d-sm-none d-lg-inline" ><small>Paikannimi:</small></label>
    				<input type="text" class="form-control form-control-sm my-sm-1 my-md-1 my-lg-0" id="obs-place-name" placeholder="anna paikka" size="25">
    	</form>

    	
    	 <form class="needs-validation" id="bird-form" novalidate>
    			<fieldset>
    				<div class="col-6 col-xl-6 py-1 pl-0 mr-xl-0">
						Linnun paikka
						</div> 

    				<div class="row m-0 p-0 justify-content-start">
              <div class="col-lg-3 col-sm-3 col-3 mr-1 p-0">
    				    <label class="mb-1"><small>P-koord:</small></label>
    				    <input type="text" class="form-control form-control-sm" id="bird-n-koord" placeholder="0000000" size="8" readonly />
              </div>
              <div class="col-lg-3 col-sm-3 col-3 mx-1 p-0">
    				    <label class="mb-1"><small>I-koord:</small></label>
    				    <input type="text" class="form-control form-control-sm" id="bird-e-koord" placeholder="000000" size="6" readonly />	
              </div>  
              <div class="col-lg-3 col-sm-3 col-auto mx-1 p-0 align-self-end">
                <label class="mb-1"><small>Tarkkuus:</small></label>
                <select class="custom-select form-control-sm d-block" id="bird-accuracy" disabled>
                  <option selected value="0">ei määr.</option>
                  <option value="10">alle 10 m</option>
                  <option value="50">alle 50 m</option>
                  <option value="250">alle 250 m</option>
                  <option value="500">alle 500 m</option>
                  <option value="501">yli 500 m</option>
                  </select> 
              </div> 
              <div class="btn-group col-lg-2 col-sm-1 col-1 ml-0 p-0 align-self-end"> 	
                 <button type="button" class="btn btn-sm btn-danger" id="btn-clear-bird" data-toggle="tooltip" data-placement="bottom" title="Tyhjennä linnun paikka"><i class="fa fa-times" aria-hidden="true"></i></button>

                 <button type="button" class="btn btn-sm btn-secondary" id="btn-connect-bird" data-toggle="tooltip" data-placement="bottom" title="Aseta samaksi kuin havaintopaikka"><i class="fa fa-clone" aria-hidden="true"></i></button>

               </div>   

          </div>  
  
          </fieldset>
        </form>


    <div class="py-3" >            
 			<button class="btn btn-primary btn-sm" type="button" ><i class="fa fa-check fa-1x" aria-hidden="true"></i> Tallenna omiin paikkoihin</button>
    </div>

    <div class="py-3">
        <button class="btn btn-primary btn-sm" type="button"><i class="fa fa-lock fa-1x" aria-hidden="true"></i> Lukitse paikka</button>
    </div>

    <div class="bottom-column">
          
          <button type="button" class="btn btn-info" data-toggle="modal" data-target="#tietoa-sivusta">
          <i class="fa fa-info fa-1x" aria-hidden="true"></i> Sivusta
          </button>   

          <!-- Modal -->
          <div class="modal fade" id="tietoa-sivusta" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="">Mikä tämä sivu on?</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body info-flip" id="info"> 
                <div class="reverse-flip">  

                  <p>Luonnos siitä millainen viisas lintuhavaintojärjestelmän karttapohja voisi olla vuonna 2017 ja tulevaisuudessa. Teknisiä kohokohtia:
                  <ul>
                    <li>Havaintokunta määräytyy koordinaattipisteen perusteella. Siten paikan kirjaaminen väärään kuntaan tai ulkomaahan on estetty.</li>
                    <li>Kartan voi paikantaa sijaintiin, jossa työskennellään.</li>
                    <li>Ennestään tallennetut omat ja lintuyhdistysten havaintopaikat valittavissa listalta tai kartalta.</li> 
                    <li>3 nopeasti latautuvaa, <span class="p-1 bg-info-light"> helposti vieritettävää</span> taustakarttaa.</li>
                    <li>Automaattiset paikannimiehdotukset (tulossa).</li>
                  </ul></p>
                  <p>Aineistolähteet:
                  <ul>
                    <li>Maastokartta ja taustakartta: MML paikkatiedon testipalvelu 2017, WMTS</li>
                    <li>Ilmakuva: WMTS-palvelu kartat.kapsi.fi, kuva-aineisto MML 2017 </li>
                    <li>Kuntarajat 1:10 000: WFS-palvelu Paituli / CSC - Tieteen tietotekniikan keskus, aineisto MML 2017</li>
                    <li>Yhdistyspaikat: LLY:n alueen lintutornit, omat paikat: satunnainen esimerkkiaineisto</li>  
                  </ul></p>
                  <p>Tekniikat:
                  <ul>
                    <li><span class="p-1 bg-info-light">Leaflet 1.2</span>, Leaflet.MML-layers, Proj4.js, Proj4leaflet.js ja muita Leaflet-liitännäisiä</li>
                    <li>jQuery 3.2</li>
                    <li>List.js</li>
                    <li>Bootstrap 4.0</li>
                  </ul></p>
                  <p>Toteutus:</p>
                  <address>Antti Ruonakoski <span class="text-secondary">aruonakoski@gmail.com</span> <a href="https://github.com/anttiruonakoski/korppi">https://github.com/anttiruonakoski/korppi</a></address>
                </div>  
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal">Selvä!</button>
                </div>
              </div>
            </div>
          </div> 

          <!-- Modal sitelist scaffolding -->
     <div class="modal" id="site-list-modal" tabindex="-1" role="dialog" aria-labelledby="sitelistlabel" aria-hidden="true">
       <div class="modal-dialog modal-lg modal-md-lg" role="document">
         <div class="modal-content">
           <div class="modal-header" id="sites-title">

          		<div class="input-group mr-3" id="sites-input">
            	<span class="input-group-addon" id="basic-addon1"><i class="fa fa-search" aria-hidden="true"></i></span>

            	<input type="text" id="sites-search" class="form-control search" placeholder="havaintopaikka" aria-label="Username" aria-describedby="basic-addon1">
            	<!-- not autofocused -->
            	<span class="input-group-addon"><i class="fa fa-ban" aria-hidden="true"></i></span>

          		</div>
             <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
             </button>
           </div>
           <div class="modal-body pt-2" id="sites-content">
             <div class="row" id="tabs" >
               <div class="col-12" id="tabheader"> tabis tähä </div>  


               </div> 
             </div>
           <div class="modal-footer">
             <button type="button" class="btn btn-primary" data-dismiss="modal">Selvä!</button>
           </div>
         </div>
       </div>
     </div>           

    </div>  
      	</div>
  	</div>
  	</div>
  	</div>
  	
<div class="row hack">
  	<div class="col mt-2">
  	<form>
  	<div class="form-row">
  		<div class ="col-2">
  			<input type="text" class="form-control form-control-sm" placeholder="Laji">
  		</div>
  		<div class ="col-1">
  			<input type="text" class="form-control form-control-sm" placeholder="Lkm">
  		</div>
  		<div class ="col-7">
  			<p>Havainnon tiedot tulevat tänne</p>
  		</div>
  	</div>
  	</form>
  	</div>
  	</div> 

  	
  	</div>

  	<script type="text/javascript">

  const searchMinChar =3;
  var searchOff = true;

      //enable modal focus
    $('#site-list-modal').on('shown.bs.modal', function () {
    $("#sites-search").val(null);
    // $(this).find('#sites-search').focus();
    });

 	  $('#sites-search').on('input', function() {

  	var searchString = $(this).val();

    if (searchString.length >= searchMinChar) {
      sList[0].search(searchString);
      sList[1].search(searchString);
      searchOff = false;
    }
    else {  
    if (searchString.length === searchMinChar-1 && searchOff === false) {
      searchOff = true;
      sList[0].search();
      sList[1].search();
    }   
    } 
		});

    $('#site-list-modal').on('hidden.bs.modal', function () {
    if (searchOff === false) {
        sList[0].search();
        sList[1].search();
    }   
    });
   
    // $(this).find('#sites-search').focus();

  </script>

	</body>
  
</html>